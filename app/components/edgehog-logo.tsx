"use client";

import { useCallback, useState } from "react";

type EdgehogLogoProps = {
  className?: string;
  staticMode?: boolean;
  variant?: "full" | "icon";
  theme?: "light" | "dark";
};

const SPIKE_DIRECTIONS = [
  { x: -0.7, y: -0.7 },
  { x: 0.0, y: -1.0 },
  { x: 0.7, y: -0.7 },
  { x: 1.0, y: -0.2 },
  { x: 1.0, y: 0.0 },
  { x: 0.7, y: 0.2 },
  { x: -0.7, y: -0.7 },
];

const SPIKE_PATHS = [
  "M40.1634 15.2877C40.1397 15.1335 40.1042 14.944 40.0503 14.7159C40.0509 14.7099 40.0509 14.7038 40.0503 14.6977C39.6655 13.0476 38.3721 9.40479 34.1017 2.50138L33.7503 1.93921L33.6792 2.22832C31.6895 10.3471 31.5817 14.293 31.7337 16.0062C31.7337 16.0127 31.7337 16.018 31.7337 16.0244C31.7542 16.2579 31.779 16.4528 31.8037 16.6037C31.8037 16.6037 31.8037 16.6112 31.8037 16.6145C31.8037 16.6177 31.8037 16.6305 31.8037 16.6391C31.8037 16.6637 31.8124 16.6873 31.8167 16.7087C32.3556 19.8836 34.6244 22.1537 36.9095 21.7939C39.1945 21.4341 40.6409 18.5815 40.1699 15.3937C40.1699 15.3716 40.1667 15.3481 40.1602 15.3231V15.2984C40.1606 15.2947 40.1617 15.2911 40.1634 15.2877Z",
  "M52.8884 15.8617C52.9099 15.6925 52.9293 15.4837 52.9434 15.2299C52.9428 15.2231 52.9428 15.2163 52.9434 15.2096C53.0371 13.3699 52.786 9.17885 50.4094 0.691734L50.2121 0L50.0504 0.280549C45.5181 8.16802 44.2215 12.267 43.8593 14.1013C43.8593 14.1077 43.8593 14.1141 43.8593 14.1206C43.8108 14.3701 43.7785 14.5778 43.7591 14.747C43.7596 14.7509 43.7596 14.7548 43.7591 14.7588C43.7591 14.7673 43.7591 14.777 43.7591 14.7855C43.7591 14.8123 43.7526 14.838 43.7505 14.8626C43.3614 18.3416 45.0439 21.3891 47.5391 21.6943C50.0343 21.9995 52.4098 19.4456 52.8798 15.9762C52.8798 15.9527 52.8873 15.927 52.8905 15.9002V15.8734C52.8905 15.8734 52.8873 15.8649 52.8884 15.8617Z",
  "M65.1025 20.556C65.179 20.3965 65.2663 20.1963 65.3612 19.9489L65.3687 19.9296C66.0575 18.1382 67.1666 13.9075 67.5621 4.74577L67.5902 3.99622L67.339 4.22215C60.2986 10.5837 57.688 14.2277 56.7352 15.9281L56.7245 15.9463C56.5951 16.1776 56.497 16.3746 56.4226 16.5341L56.4173 16.5449L56.4054 16.5706L56.372 16.6444C54.863 19.9639 55.5377 23.5189 57.9112 24.6186C60.2846 25.7183 63.461 23.9483 65.0497 20.6631C65.0605 20.6406 65.0723 20.616 65.0853 20.5914C65.0888 20.5826 65.0927 20.574 65.0971 20.5657L65.1025 20.556Z",
  "M73.7964 28.4146C73.8902 28.2882 74.0001 28.1287 74.1251 27.9295L74.1348 27.9145C75.0381 26.4721 76.7217 22.9803 78.624 15.0789L78.776 14.4364L78.5195 14.5917C71.3152 18.9402 68.4255 21.6707 67.31 22.9899L67.2981 23.0038C67.1461 23.1837 67.0276 23.3368 66.936 23.4643L66.9284 23.4728C66.9244 23.48 66.9197 23.4868 66.9144 23.4932L66.8734 23.5521C64.9937 26.1852 64.9786 29.39 66.8551 30.7446C68.7316 32.0992 71.7949 31.0937 73.7339 28.5045C73.7479 28.4863 73.763 28.467 73.777 28.4467L73.7921 28.4274C73.7941 28.4233 73.7956 28.419 73.7964 28.4146Z",
  "M80.8389 36.2689C80.9348 36.1747 81.0545 36.0548 81.1827 35.9017L81.1935 35.8899C82.1528 34.7902 84.0498 32.0586 86.725 25.6252L86.9406 25.0995L86.7024 25.1959C80.0198 27.9167 77.2034 29.8431 76.0792 30.81L76.0673 30.8207C75.9143 30.9525 75.7925 31.067 75.6976 31.1623L75.6912 31.1688L75.6761 31.1837L75.633 31.2276C73.6864 33.2065 73.2412 35.9167 74.6467 37.313C76.0522 38.7093 78.7802 38.267 80.7721 36.3332L80.8163 36.2904L80.8314 36.2754L80.8389 36.2689Z",
  "M86.3218 44.453C86.4166 44.3876 86.5374 44.303 86.6667 44.1938C86.6707 44.1916 86.6744 44.1887 86.6775 44.1853C87.6475 43.3982 89.662 41.3734 92.8858 36.3374L93.1467 35.9252L92.9311 35.9712C86.8801 37.2808 84.2157 38.4908 83.1228 39.1408L83.1109 39.1483C82.9622 39.2371 82.8425 39.3153 82.7477 39.3817H82.7412L82.7261 39.3924L82.6841 39.4234C80.744 40.8058 79.9625 43.0277 80.9391 44.4144C81.9156 45.8011 84.2868 45.8311 86.2571 44.4936L86.3013 44.4637L86.3164 44.454L86.3218 44.453Z",
  "M28.4086 18.181C28.3666 18.0418 28.3094 17.8726 28.2307 17.6691L28.2243 17.6531C27.6541 16.1861 25.9932 13.0026 21.172 7.20211L20.7764 6.73096L20.7484 7.00615C19.9702 14.7223 20.3927 18.3673 20.7484 19.9231V19.9403C20.798 20.1544 20.8454 20.3247 20.8896 20.4628C20.8896 20.4628 20.8896 20.4692 20.8896 20.4735C20.8926 20.4805 20.8951 20.4876 20.8971 20.4949L20.9176 20.5581C21.8305 23.4064 24.2072 25.2032 26.2615 24.579C28.3159 23.9547 29.2795 21.1449 28.428 18.2763C28.4226 18.2559 28.4161 18.2345 28.4097 18.2131L28.4032 18.1906L28.4086 18.181Z",
];

const TEXT_PATHS = [
  "M3.01911 62.0665H10.1555V64.4854H0.00115967V51.4592H9.90865V53.8781H3.01911V56.7125H9.10673V59.0565H3.01911V62.0665ZM12.572 64.4854V51.4592H18.5281C19.9509 51.4592 21.2083 51.729 22.3005 52.2687C23.3516 52.7708 24.2356 53.5621 24.8475 54.5484C25.4532 55.5286 25.7561 56.6707 25.7561 57.975C25.7561 59.2778 25.4532 60.4199 24.8475 61.4015C24.2335 62.3853 23.3485 63.1735 22.2973 63.6727C21.2044 64.2123 19.9469 64.4822 18.5249 64.4822H12.5677L12.572 64.4854ZM15.6061 62.0108H18.3783C19.6889 62.0108 20.7344 61.6478 21.5148 60.9218C22.2952 60.1958 22.6853 59.2128 22.6853 57.9728C22.6853 56.7329 22.2952 55.7499 21.5148 55.0239C20.7344 54.2979 19.6889 53.9349 18.3783 53.9349H15.6018L15.6061 62.0108ZM36.9009 61.5825V57.7672H39.6656V63.0516C38.9204 63.6021 38.0834 64.0178 37.193 64.2798C36.2774 64.5619 35.3245 64.7063 34.3659 64.7081C33.0049 64.7081 31.7812 64.4197 30.6947 63.8429C29.636 63.2922 28.7512 62.4613 28.1381 61.4422C27.5127 60.3925 27.1919 59.1914 27.2112 57.9718C27.1919 56.7521 27.5127 55.551 28.1381 54.5013C28.7568 53.4782 29.6509 52.6471 30.7195 52.1017C31.8175 51.5241 33.0538 51.2357 34.4284 51.2365C35.4983 51.222 36.5606 51.4178 37.5541 51.8125C38.4626 52.178 39.271 52.7519 39.9135 53.4873L37.9658 55.2744C37.0317 54.2936 35.9018 53.8035 34.576 53.8042C33.8009 53.7898 33.0346 53.9687 32.3471 54.3246C31.7091 54.6598 31.1815 55.1701 30.8273 55.7948C30.4584 56.4609 30.2725 57.2117 30.2884 57.9718C30.2739 58.7259 30.4598 59.4705 30.8273 60.1305C31.1809 60.7542 31.7037 61.2666 32.3363 61.6092C33.0113 61.973 33.7694 62.1574 34.5372 62.1446C35.3584 62.1574 36.1696 61.9652 36.8966 61.5857L36.9009 61.5825ZM45.4935 62.0665H52.6298V64.4854H42.4788V51.4592H52.3841V53.8781H45.4935V56.7125H51.5811V59.0565H45.4935V62.0665Z",
  "M65.0098 51.4591H66.3776V64.4843H65.0098V58.4739H56.8031V64.4843H55.4203V51.4591H56.8031V57.265H65.0065L65.0098 51.4591ZM76.3788 64.5956C75.1467 64.6123 73.9309 64.3143 72.8478 63.7304C71.8203 63.1804 70.9652 62.3598 70.3763 61.3586C69.7765 60.3305 69.4688 59.1599 69.486 57.9717C69.4687 56.7838 69.7764 55.6135 70.3763 54.5858C70.9656 53.5853 71.8207 52.7651 72.8478 52.2151C73.9309 51.6312 75.1467 51.3333 76.3788 51.3499C77.6039 51.3319 78.8131 51.6269 79.8904 52.2065C80.914 52.7593 81.7658 53.5799 82.3533 54.5794C82.9576 55.6092 83.2684 56.783 83.2522 57.9749C83.2684 59.1668 82.9576 60.3406 82.3533 61.3704C81.7661 62.3701 80.9143 63.1908 79.8904 63.7433C78.8131 64.3229 77.6039 64.6179 76.3788 64.5999V64.5956ZM76.3788 63.3685C77.3602 63.3818 78.3282 63.1412 79.1877 62.6703C80.0109 62.2186 80.6918 61.5488 81.1547 60.7354C81.6335 59.8928 81.879 58.9392 81.8661 57.9717C81.8791 57.0045 81.6336 56.0512 81.1547 55.209C80.6926 54.3951 80.0114 53.7252 79.1877 53.2741C78.3284 52.8027 77.3603 52.5621 76.3788 52.576C75.3944 52.5628 74.4233 52.8033 73.5603 53.2741C72.731 53.726 72.0438 54.3972 71.5749 55.2133C71.09 56.0535 70.841 57.0076 70.8538 57.976C70.8411 58.9447 71.0901 59.8991 71.5749 60.7397C72.045 61.5537 72.732 62.2232 73.5603 62.6746C74.4235 63.1447 75.3944 63.3852 76.3788 63.3728V63.3685ZM95.5956 62.363V57.9728H96.9246V62.9412C96.2887 63.4883 95.5508 63.9056 94.7527 64.1695C93.9025 64.4568 93.0101 64.6015 92.112 64.5978C90.8776 64.6165 89.6588 64.3217 88.5713 63.7411C87.5435 63.1907 86.688 62.3697 86.0988 61.3683C85.4944 60.3385 85.1836 59.1647 85.1998 57.9728C85.1836 56.7808 85.4944 55.607 86.0988 54.5773C86.6885 53.5761 87.5438 52.7553 88.5713 52.2044C89.6204 51.6333 90.806 51.3478 92.1282 51.3478C93.0672 51.3375 94.0003 51.4982 94.881 51.8221C95.6877 52.119 96.4129 52.6003 96.9978 53.227L96.1356 54.1018C95.0987 53.0846 93.7812 52.576 92.1831 52.576C91.1807 52.5612 90.1911 52.8016 89.3086 53.2741C88.4708 53.7233 87.775 54.3946 87.2984 55.2133C86.8075 56.0515 86.5549 57.0063 86.5676 57.976C86.5543 58.943 86.8069 59.8953 87.2984 60.7301C87.7783 61.5429 88.4706 62.2115 89.3021 62.665C90.1796 63.1436 91.1671 63.3875 92.1681 63.3728C93.5161 63.3728 94.6586 63.0376 95.5956 62.3673V62.363Z",
  "M33.261 76.0778V67.6539H29.9811V66.8058H37.526V67.6539H34.2483V76.0778H33.261ZM46.554 76.0778H45.4761L43.3409 73.0957C43.0928 73.1221 42.8435 73.1354 42.594 73.1353H40.088V76.0757H39.1007V66.8058H42.594C43.7846 66.8058 44.7188 67.0885 45.3964 67.6539C46.074 68.2193 46.4117 68.9963 46.4095 69.985C46.4095 70.7089 46.2252 71.3203 45.8566 71.8193C45.488 72.3183 44.9613 72.6781 44.2765 72.8986L46.554 76.0778ZM42.566 72.3033C43.4908 72.3033 44.1975 72.1002 44.6861 71.694C45.1747 71.2878 45.4194 70.7167 45.4201 69.9807C45.4201 69.2304 45.1754 68.6544 44.6861 68.2525C44.1967 67.8505 43.49 67.6496 42.566 67.6496H40.0869V72.3033H42.566ZM55.7156 76.0778L54.5935 73.6011H49.3941L48.2742 76.0778H47.247L51.5142 66.8058H52.4842L56.7503 76.0778H55.7156ZM49.7541 72.8066H54.2335L51.9938 67.8263L49.7541 72.8066ZM58.3002 76.0778V66.8058H62.0996C63.0063 66.7875 63.9037 66.9901 64.7134 67.3958C65.4449 67.766 66.0554 68.3354 66.4735 69.0373C66.8983 69.7676 67.1148 70.5991 67.0997 71.4424C67.1144 72.2849 66.8979 73.1156 66.4735 73.8452C66.0551 74.5473 65.4448 75.1169 64.7134 75.4878C63.9034 75.8927 63.0061 76.0949 62.0996 76.0768H58.3002V76.0778ZM59.2864 75.2298H62.0468C62.7912 75.2466 63.5283 75.0807 64.1928 74.7468C64.7861 74.4435 65.2809 73.9794 65.6198 73.4083C65.9649 72.8107 66.14 72.1312 66.1264 71.4424C66.1401 70.7532 65.965 70.0733 65.6198 69.4753C65.2809 68.9042 64.7861 68.4402 64.1928 68.1368C63.5283 67.8029 62.7912 67.6371 62.0468 67.6539H59.2821L59.2864 75.2298ZM69.3103 76.0778V66.8058H70.2976V76.0778H69.3103ZM80.1631 66.8058H81.1331V76.0778H80.3204L74.3201 68.5544V76.0778H73.3339V66.8058H74.1563L80.1685 74.3292L80.1631 66.8058ZM90.755 74.568V71.4424H91.7013V74.976C91.2489 75.3656 90.7237 75.6629 90.1557 75.8508C89.5505 76.0556 88.9153 76.1591 88.276 76.1571C87.3974 76.1708 86.5299 75.9611 85.756 75.5478C85.0246 75.1562 84.4159 74.5719 83.9969 73.8592C83.5666 73.1262 83.3453 72.2908 83.3567 71.4424C83.3443 70.5947 83.5641 69.7597 83.9926 69.0266C84.4116 68.3139 85.0203 67.7296 85.7517 67.338C86.5305 66.9242 87.4026 66.7145 88.2857 66.7287C88.9541 66.7213 89.6182 66.8356 90.2452 67.066C90.8202 67.277 91.3372 67.6196 91.7541 68.0661L91.1409 68.6893C90.4029 67.964 89.4652 67.6018 88.3277 67.6025C87.6136 67.5922 86.9087 67.7632 86.2798 68.0993C85.6831 68.4185 85.187 68.8955 84.8463 69.4774C84.4973 70.0744 84.3178 70.7542 84.3268 71.4445C84.3173 72.1325 84.497 72.81 84.8463 73.4041C85.1885 73.9826 85.6815 74.4587 86.2733 74.7822C86.8978 75.1225 87.6005 75.2959 88.3126 75.2855C89.2726 75.2855 90.086 75.047 90.7528 74.5702L90.755 74.568Z",
];

export function EdgehogLogo({
  className = "",
  staticMode = false,
  variant = "full",
  theme,
}: EdgehogLogoProps) {
  const [hovered, setHovered] = useState(false);
  const [winking, setWinking] = useState(false);
  const spikeOffset = 8;
  const springEasing = "cubic-bezier(0.34, 1.56, 0.64, 1)";
  const viewBox = variant === "icon" ? "-10 -10 120 110" : "-24 -24 242 202";
  const fillColor = theme === "light" ? "#1a1a1a" : "#ffffff";

  const triggerWink = useCallback(() => {
    setWinking(true);
    setTimeout(() => setWinking(false), 240);
  }, []);

  return (
    <button
      type="button"
      aria-label="Edgehog logo"
      className={`logo-wrap ${variant === "full" ? "logo-wrap-full" : "logo-wrap-icon"} ${className}`}
      onMouseEnter={() => !staticMode && setHovered(true)}
      onMouseLeave={() => setHovered(false)}
      onClick={triggerWink}
      onKeyDown={(e) => {
        if (e.key === "Enter" || e.key === " ") {
          e.preventDefault();
          triggerWink();
        }
      }}
    >
      <svg
        viewBox={viewBox}
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        className="logo-svg"
        role="img"
      >
        <g transform="scale(2)">
          <ellipse cx="5.07" cy="39.11" rx="2.37" ry="2.36" fill={fillColor} />
          <ellipse
            cx="20.35"
            cy="32.55"
            rx="3.7"
            ry="3.68"
            fill={fillColor}
            className={winking ? "logo-eye logo-eye-now" : "logo-eye logo-eye-auto"}
            style={{
              transformOrigin: "20.35px 32.55px",
              transform: winking ? "scaleY(0.1)" : undefined,
            }}
          />
          {SPIKE_PATHS.map((d, i) => {
            const dir = SPIKE_DIRECTIONS[i];
            const tx = hovered ? dir.x * spikeOffset : 0;
            const ty = hovered ? dir.y * spikeOffset : 0;

            return (
              <path
                key={d.slice(0, 24)}
                d={d}
                fill={fillColor}
                style={{
                  transform: `translate(${tx}px, ${ty}px)`,
                  transition: `transform 0.3s ${springEasing}`,
                }}
              />
            );
          })}
          {variant === "full" &&
            TEXT_PATHS.map((d) => (
              <path key={d.slice(0, 30)} d={d} fill={fillColor} />
            ))}
        </g>
      </svg>
    </button>
  );
}

export default EdgehogLogo;
